<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="summary" name="twitter:card"/>
<meta content="https://ngc7292.github.io/images/avatar.png" name="twitter:image"/>
<meta content="neural network and BP algorithm" name="twitter:title"/>
<meta content="learning by ngc7293" name="twitter:description"/>
<meta content="@ngc7293" name="twitter:site"/>
<meta content="@ngc7293" name="twitter:creator"/>
<meta content="ngc7293" name="author"/>
<meta content="Hugo 0.78.1" name="generator"/>
<title>neural network and BP algorithm Â· ngc7293's blog</title>
<link href="https://ngc7292.github.io/images/favicon.ico" rel="shortcut icon"/>
<link href="https://ngc7292.github.io/css/style.css" rel="stylesheet"/>
<link href="https://ngc7292.github.io/css/highlight.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/gh/ngc7292/live2d-widget@latest/autoload.js"></script>
<link href="https://ngc7292.github.io/css/font-awesome.min.css" rel="stylesheet"/>
<link href="https://ngc7292.github.io/index.xml" rel="alternate" title="ngc7293's blog" type="application/rss+xml"/>
<script async="" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript">
  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });

  MathJax.Hub.Config({
  
  TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script>
<style>
code.has-jax {
    font: inherit;
    font-size: 100%;
    background: inherit;
    border: inherit;
    color: #515151;
}
</style>
</head>
<body>
<nav class="main-nav">
<a href="https://ngc7292.github.io/"> <span class="arrow">â†</span>Home</a>
<a href="https://ngc7292.github.io/posts">Archive</a>
<a href="https://ngc7292.github.io/tags">Tags</a>
<a href="https://ngc7292.github.io/about">About</a>
<a class="cta" href="https://ngc7292.github.io/index.xml">Subscribe</a>
</nav>
<section class="post" id="wrapper">
<article>
<header>
<h1>
                        neural network and BP algorithm
                    </h1>
<h2 class="headline">
                    Jan 1, 1970 08:33
                    Â· 388 words
                    Â· 2 minute read
                      <span class="tags">
<a href="https://ngc7292.github.io/tags/mechine-learning">mechine learning</a>
<a href="https://ngc7292.github.io/tags/algorithm">algorithm</a>
</span>
</h2>
</header>
<div id="toc">
<nav id="TableOfContents">
<ul>
<li><a href="#ç¥ç»ç½‘ç»œç®€è¿°">ç¥ç»ç½‘ç»œç®€è¿°</a></li>
<li><a href="#æ„ŸçŸ¥æœºä¸å¤šé‡ç¥ç»ç½‘ç»œ">æ„ŸçŸ¥æœºä¸å¤šé‡ç¥ç»ç½‘ç»œ</a></li>
<li><a href="#bpè¯¯å·®é€†ä¼ æ’­ç®—æ³•">BP(è¯¯å·®é€†ä¼ æ’­ç®—æ³•)</a>
<ul>
<li></li>
</ul>
</li>
<li><a href="#è¿­ä»£ä¼˜åŒ–ç®—æ³•">è¿­ä»£ä¼˜åŒ–ç®—æ³•</a>
<ul>
<li></li>
</ul>
</li>
</ul>
</nav>
</div>
<section id="post-body">
<p>è¥¿ç“œä¹¦çš„ç¬”è®°</p>
<h2 id="ç¥ç»ç½‘ç»œç®€è¿°">ç¥ç»ç½‘ç»œç®€è¿°</h2>
<p>ç¥ç»ç½‘ç»œæœ€åŸºæœ¬ç»„æˆæˆåˆ†æ˜¯ç¥ç»å…ƒï¼Œæ¯ä¸ªç¥ç»å…ƒè¾“å…¥çš„ä¿¡å·é€šè¿‡å¸¦æƒè¿æ¥è¿›å…¥ç›¸åº”çš„ç¥ç»å…ƒï¼Œå¹¶å°†æ€»è¾“å…¥å€¼ä¸é˜ˆå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå¹¶é€šè¿‡æ¿€æ´»å‡½æ•°è¿›è¡Œè¾“å‡ºã€‚</p>
<p>å…¸å‹çš„æ¿€æ´»å‡½æ•°åŒ…æ‹¬åƒsigmoidå‡½æ•°æˆ–è€…è·ƒè¿å‡½æ•°ä¹‹ç±»çš„ï¼Œsigmoidå‡½æ•°åˆè¢«ç§°ä¸ºæŒ¤å‹å‡½æ•°ï¼Œå¥½åƒæ˜¯è¯´æŠŠæ•°å­—éƒ½æŒ¤å‹åˆ°[0,1]åŒºé—´ä¸Šçš„å‡½æ•°ï¼Œå…¶æ•°å­¦è¡¨ç¤ºä¸ºï¼š</p>
<p>$$ sigmoid(x) = 1/(1+e^{-x}) $$</p>
<p>å‡½æ•°å›¾å½¢ç±»ä¼¼è¿™æ ·ï¼š</p>
<p><img alt="" src="http://ngcimage.tan90.me/image/blog/sigmoid.jpg"/></p>
<p>å¾ˆå¤šç¥ç»å…ƒè¿æ¥äºæ˜¯å¾—åˆ°ç¥ç»ç½‘ç»œï¼Œä»è®¡ç®—æœºç§‘å­¦çš„è§’åº¦ï¼Œç¥ç»ç½‘ç»œå¯ä»¥çœ‹ä½œä¸€ä¸ªæ¨¡å‹ï¼Œè¯¥æ¨¡å‹æœ‰è®¸å¤šå‡½æ•°ï¼Œå¹¶ä¸”åœ¨å¾ˆå¤šæ—¶å€™å¯ä»¥é€’å½’ä»€ä¹ˆçš„ï¼Œæœ€åç»™å‡ºä¸€ä¸ªè¾“å‡ºï¼Œç±»ä¼¼çš„ï¼Œå®ç°ä¸‹åˆ—ç›¸äº’åµŒå¥—ï¼Œç›¸äº’ä½œç”¨çš„ä¸€äº›å‡½æ•°ç»¼åˆè€Œæˆçš„æ¨¡å‹ï¼Œå¾ˆå¤šéƒ½æ˜¯ä»¥æ•°å­¦è¯æ˜ä¸ºåŸºç¡€çš„ã€‚</p>
<p>$$ y_j = f(\Sigma_i w_ix_i - \theta_j)$$</p>
<h2 id="æ„ŸçŸ¥æœºä¸å¤šé‡ç¥ç»ç½‘ç»œ">æ„ŸçŸ¥æœºä¸å¤šé‡ç¥ç»ç½‘ç»œ</h2>
<p>æ„ŸçŸ¥æœºæ˜¯æˆ‘æ„Ÿè§‰æœ€ç®€å•çš„ä¸€ç§ç¥ç»ç½‘ç»œï¼Œå…¶ç”±ä¸¤å±‚ç¥ç»å…ƒæ„æˆçš„ï¼Œå¯¹äºçº¿æ€§å¯åˆ†é—®é¢˜æ¯”å¦‚å…³äºä¸ï¼Œæˆ–ï¼Œéç­‰é—®é¢˜ï¼Œå³å­˜åœ¨ä¸€ä¸ªçº¿æ€§è¶…å¹³é¢å¯ä»¥å°†æ‰€æœ‰çš„è¾“å…¥åˆ’åˆ†ä¸ºä¸¤ä¸ªæ¨¡å¼é‚£ç§ï¼Œå¯¹äºéçº¿æ€§å¯åˆ†é—®é¢˜ï¼Œæ„ŸçŸ¥æœºå¯èƒ½ä¼šæœ‰äº›é—®é¢˜ï¼Œæ¯”å¦‚äº§ç”Ÿéœ‡è¡ï¼ˆfluctuationï¼‰ï¼Œå³ä¸€ç›´åœ¨ä¸¤ä¸ªæ¨¡å—ä¹‹é—´è·Œå®•ï¼Œå¾—ä¸åˆ°æœ€åçš„xçš„å‚æ•°ã€‚</p>
<p>å½“å‡ºç°è¿™äº†é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å¤šå±‚ç¥ç»ç½‘ç»œï¼Œä¸€èˆ¬å¸¸è§çš„æœ‰å¤šå±‚å‰é¦ˆç½‘ç»œï¼Œç”±è¾“å…¥å±‚å¤„ç†å¤–ç•Œä¿¡å·ï¼Œç”±éšå±‚å¤„ç†æ•°æ®ï¼Œç”±è¾“å‡ºå±‚è¾“å‡ºï¼Œç½‘ç»œçš„å­¦ä¹ è¿‡ç¨‹å°±æ˜¯å¯¹å…¶ä¸­çš„è¿æ¥æƒï¼Œä»¥åŠå„ä¸ªå±‚ä¹‹é—´çš„é˜ˆå€¼ã€‚</p>
<p><img alt="" src="http://ngcimage.tan90.me/image/blog/mLP.jpg"/></p>
<h2 id="bpè¯¯å·®é€†ä¼ æ’­ç®—æ³•">BP(è¯¯å·®é€†ä¼ æ’­ç®—æ³•)</h2>
<p>é¦–å…ˆç»™å®šä¸€ä¸ªè®­ç»ƒé›†</p>
<p>$$ D = {(x_1,y_1),(x_2,y_2),â€¦,(x_m,y_m)} x_i \in R^d y_i \in R^l$$</p>
<p>è¡¨ç¤ºè®­ç»ƒé›†ç”±dä¸ªå±æ€§æè¿°ï¼Œè¾“å‡ºlç»´å®å€¼å‘é‡</p>
<p>ä¸‹é¢æ˜¯è¯¥ç®—æ³•çš„ä¸€äº›è¡¨ç¤ºï¼š</p>
<p>$$ \theta_j è¡¨ç¤ºè¾“å‡ºå±‚ç¬¬jä¸ªç¥ç»å…ƒé˜ˆå€¼$$</p>
<p>$$ \gamma_{h} è¡¨ç¤ºéšå±‚ç¬¬hä¸ªç¥ç»å…ƒçš„é˜ˆå€¼$$</p>
<p>$$ \nu_{ih} è¡¨ç¤ºç¬¬iä¸ªè¾“å…¥å±‚ç¥ç»å…ƒåˆ°ç¬¬hä¸ªéšå±‚ç¥ç»å…ƒçš„è¿æ¥æƒ$$</p>
<p>$$ \omega_{hj} è¡¨ç¤ºç¬¬hä¸ªéšå±‚ç¥ç»å…ƒåˆ°ç¬¬jä¸ªè¾“å‡ºå±‚ç¥ç»å…ƒçš„è¿æ¥æƒ$$</p>
<p>$$ \alpha_{h} = \sum ^{d} _{i=1}\nu _{ih}x_i è¡¨ç¤ºéšå±‚ç¥ç»å…ƒæ¥æ”¶åˆ°çš„è¾“å…¥$$</p>
<p>$$ \beta_j = \sum^{q} _{h=1} \omega _{hi}b_h è¡¨ç¤ºè¾“å‡ºå±‚ç¬¬jä¸ªç¥ç»å…ƒæ¥æ”¶çš„è¾“å…¥$$</p>
<p>å‡è®¾ç¥ç»å…ƒéƒ½ä½¿ç”¨sigmoidå‡½æ•°ï¼Œå‡å®šç¥ç»ç½‘ç»œè¾“å‡ºä¸ºï¼š</p>
<p>$$ \widehat {y}^k_j = f(\beta_j - \theta_j) $$</p>
<p>å‡æ–¹è¯¯å·®ï¼š</p>
<p>$$ E_{k}=\dfrac {1}{2}\sum ^{l} _{j=1}( \widehat {y}^k _{j}-y^k _{j}) $$</p>
<p>æ³¨ï¼š1/2çš„æ˜¯ä¸ºäº†æ±‚å¯¼æ–¹ä¾¿</p>
<p>BPç®—æ³•æ˜¯åŸºäºæ¢¯åº¦ä¸‹é™ç­–ç•¥çš„ï¼Œä»¥ç›®æ ‡çš„è´Ÿæ¢¯åº¦æ–¹å‘å¯¹å‚æ•°è¿›è¡Œè°ƒæ•´ã€‚</p>
<p>$$\Delta \omega _{hj}=-\eta\dfrac {\partial E _{k}}{\partial \omega _{hj}}â€‹$$</p>
<p>$$\Delta \theta _{j}=-\eta\dfrac {\partial E _{k}}{\partial \beta _{j}}â€‹$$</p>
<p>$$\Delta \nu _{ih}=-\eta\dfrac {\partial E _{k}}{\partial \nu _{ih}}$$</p>
<p>ä»¥$\omega$ä¸¾ä¾‹ï¼Œ$\omega$æ˜¯å…ˆå½±å“åˆ°$\beta$å†å½±å“yç»§è€Œå½±å“Eçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†$\omega$å¼å­è½¬åŒ–ï¼š</p>
<p>$$\dfrac {\partial E _{k}} {\partial \omega _{hj}} = \dfrac {\partial E _{k}} {\partial y^k _{j}}* \dfrac {\partial y^k _{j}} {\partial \beta _{j}}* \dfrac {\partial \beta _{j}} {\partial \omega _{hj}}$$</p>
<p>ç”±äº</p>
<p>$$f'\left( x\right) = f(x)(1-f(x))$$</p>
<p>è®¾</p>
<p>$$g_j = -\dfrac {\partial E _{k}} {\partial y^k _{j}}*\dfrac {\partial y^k _{j}} {\partial \beta _{j}} = \widehat{y}^k _j(1-\widehat{y}^k _j)(y^k _j-\widehat{y}^k _j)$$</p>
<p>æ‰€ä»¥å…³äºomegaçš„æ›´æ–°å…¬å¼ä¸º</p>
<p>$$\Delta \omega_{hj}=\eta g_jb_n$$</p>
<p>å…¶ä»–çš„æ›´æ–°å…¬å¼ä¸ºï¼š</p>
<p>$$ \Delta \theta_{j}=-\eta g_j $$</p>
<p>$$ \Delta \nu_{ih}=\eta e_h x_i $$</p>
<p>$$ \Delta \gamma_{h}=-\eta e_h $$</p>
<p>ä¹‹åä¾¿æ˜¯éå†è®­ç»ƒé›†å¹¶æ›´æ–°å…¶ä¸­çš„ä¸€ä¸ªå‚æ•°</p>
<p>å¦å¤–ï¼ŒBPç®—æ³•çš„ç›®æ ‡æ˜¯æœ€å°åŒ–è®­ç»ƒé›†ä¸Šçš„ç´¯ç§¯è¯¯å·®:</p>
<p>$$ E = 1/m\sum^m_{k=1}E_k â€‹$$</p>
<p>ä¸ºäº†ä½¿ç´¯è®¡è¯¯å·®è¾¾åˆ°æœ€å°ï¼Œæˆ‘ä»¬é€šå¸¸é‡‡ç”¨æ›´å¤šæ¬¡æ•°çš„è¿­ä»£ã€‚</p>
<h4 id="æ ‡å‡†bpç®—æ³•å’Œç´¯ç§¯bpç®—æ³•">æ ‡å‡†BPç®—æ³•å’Œç´¯ç§¯BPç®—æ³•</h4>
<p>æ ‡å‡†BPç®—æ³•æ˜¯åŸºäºå•ä¸ª$E_k$æ¨å¯¼å‡ºæ¥çš„ï¼Œç±»ä¼¼çš„ï¼ŒåŸºäºç´¯ç§¯è¯¯å·®æœ€å°åŒ–çš„æ›´æ–°è§„åˆ™ï¼Œå°±å¾—åˆ°ç´¯ç§¯BPç®—æ³•ã€‚</p>
<p>ç”±äºæ ‡å‡†BPç®—æ³•é’ˆå¯¹å•ä¸ªæ ·ä¾‹ï¼Œæ›´æ–°è¿­ä»£è¾ƒæ…¢ï¼Œè€Œç´¯ç§¯BPé‡‡ç”¨ç´¯ç§¯è¯¯å·®ï¼Œæ¯æ¬¡è¿­ä»£å¯ä»¥é’ˆå¯¹å¤šä¸ªæ ·ä¾‹ï¼Œæ›´æ–°å‚æ•°çš„é¢‘ç‡å°±ä¼šä½å¾ˆå¤šã€‚</p>
<h4 id="è¿‡æ‹Ÿåˆçš„è§£å†³">è¿‡æ‹Ÿåˆçš„è§£å†³</h4>
<p>è¿‡æ‹Ÿåˆæ˜¯æŒ‡å…¶è®­ç»ƒè¯¯å·®æŒç»­é™ä½ï¼Œä½†æ˜¯æµ‹è¯•è¯¯å·®å´ä¸æ–­å‡é«˜çš„ç°è±¡ï¼Œä¸»è¦åŸå› æ˜¯å› ä¸ºç‰¹å¾å¤ªå¤šï¼Œæ¨¡å‹æ¯”è¾ƒå¤æ‚ï¼Œå‚æ•°è¾ƒå¤šï¼Œè®­ç»ƒæ•°æ®è¾ƒå°‘ï¼Œå™ªå£°è¿‡å¤šï¼Œè¿‡åº¦æ‹Ÿåˆäº†è®­ç»ƒæ•°æ®ä½†æ˜¯å¹¶æ²¡æœ‰è€ƒè™‘åˆ°æ³›åŒ–èƒ½åŠ›ã€‚</p>
<p>å‡å°‘è¿‡æ‹Ÿåˆçš„æ–¹å¼ä¹¦ä¸Šç»™äº†ä¸¤ç§ï¼Œä¸€ç§ç­–ç•¥æ˜¯æ—©åœï¼Œè®¾ç½®è¯¯å·®é˜ˆå€¼ï¼Œè®­ç»ƒçº§ä»¥åŠæµ‹è¯•é›†ï¼Œè‹¥è®­ç»ƒè¯¯å·®é™ä½ä½†æ˜¯æµ‹è¯•è¯¯å·®å‡é«˜ï¼Œè¿”å›è¾ƒå°çš„è¿æ¥æƒã€‚</p>
<p>å¦ä¸€ç§æ˜¯æ­£åˆ™åŒ– åŸºæœ¬æ€æƒ³å°±æ˜¯åœ¨è¯¯å·®ç›®æ ‡å‡½æ•°ä¸­å¢åŠ ä¸€ä¸ªæè¿°ç½‘ç»œå¤æ‚åº¦çš„éƒ¨åˆ†ï¼Œä¾‹å¦‚è¿æ¥æƒå’Œé˜ˆå€¼çš„å¹³æ–¹ã€‚</p>
<h2 id="è¿­ä»£ä¼˜åŒ–ç®—æ³•">è¿­ä»£ä¼˜åŒ–ç®—æ³•</h2>
<h4 id="æ¢¯åº¦ä¸‹é™æ³•">æ¢¯åº¦ä¸‹é™æ³•</h4>
<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://www.jianshu.com/p/c7e642877b0e">æ·±å…¥æµ…å‡ºâ€“æ¢¯åº¦ä¸‹é™æ³•åŠå…¶å®ç°</a></p>
<p>æ¢¯åº¦ä¸‹é™æ³•æ˜¯æœ€å°äºŒä¹˜æ³•çš„ä¸€ç§ï¼Œç”¨äºæ±‚è§£æ— çº¦æŸè§„åˆ’é—®é¢˜ï¼Œç”¨äºè·å¾—æŸå¤±å‡½æ•°æˆ–è€…ä»£ä»·å‡½æ•°çš„æœ€å°åŒ–ã€‚</p>
<p>å®šä¹‰ä¸€ä¸ªå‡½æ•°$$ C = f(v_1,â€¦,v_m)$$</p>
<p>æ¢¯åº¦çš„å®šä¹‰ä¸º $$âˆ‡Câ‰¡(âˆ‚C/âˆ‚v_1,â€¦,âˆ‚C/âˆ‚v_m)^{T}$$</p>
<p>æ›´æ–°æ¢¯åº¦$$ v \rightarrow  v' = v - \eta \nabla C$$</p>
<p>ç›´åˆ°våˆ°æ— ç©·å°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æœ€å°åŒ–Cã€‚</p>
<p>æ¢¯åº¦ä¸‹é™ç®—æ³•æœ‰å¤§è‡´ä¸‰ç§å½¢å¼ï¼ŒBGDï¼ˆæ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼‰ï¼ŒSGDï¼ˆéšæœºæ¢¯åº¦ä¸‹é™ï¼‰ï¼ŒMBGDï¼ˆå°æ‰¹é‡éšæœºæ¢¯åº¦ä¸‹é™ï¼‰</p>
<p>ä¾‹å¦‚æˆ‘ä»¬å¯¹ä¸€ç»„æ•°æ®è¿›è¡Œçº¿æ€§å›å½’æ‹Ÿåˆï¼Œå…¶çº¿æ€§å‡½æ•°ä¸º</p>
<p>$$ y = b+w*x$$</p>
<p>$w$ ä½œä¸ºæƒé‡ï¼Œ$b$ä½œä¸ºåç½®ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªlosså‡½æ•°ä¸º$loss = 1/2m\sum_n(w*x-y)^2$</p>
<p>æˆ‘ä»¬å°†losså‡½æ•°æ”¹å˜ä¸€ä¸ªå†™æ³• $loss = 1/2m\sum_n(W<em>X-Y)^{T}(W</em>X-Y)$ï¼Œä¾¿äºè®¡ç®—ï¼Œè®¡ç®—losså‡½æ•°çš„å¾®åˆ†ï¼š$loss = 1/m \sum_n (W*X-Y)X^{T}$</p>
<p>é€šè¿‡æ•°æ®è®¡ç®—losså‡½æ•°çš„å€¼ï¼Œä¸æ–­é€¼è¿‘losså‡½æ•°çš„æœ€å°åŒ–</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
m <span style="color:#f92672">=</span> <span style="color:#ae81ff">20</span>

X0 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>ones((m, <span style="color:#ae81ff">1</span>))
X1 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, m <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>reshape(m, <span style="color:#ae81ff">1</span>)

X <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>hstack((X0, X1))

Y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([
    <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">12</span>,
    <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">21</span>
])<span style="color:#f92672">.</span>reshape(m, <span style="color:#ae81ff">1</span>)

lr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.01</span>


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">error_function</span>(theta, x, y):
    diff <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>dot(x, theta) <span style="color:#f92672">-</span> y
    <span style="color:#66d9ef">return</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">2.</span> <span style="color:#f92672">*</span> m) <span style="color:#f92672">*</span> (np<span style="color:#f92672">.</span>dot(np<span style="color:#f92672">.</span>transpose(diff), diff))


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">gradient_function</span>(theta, x, y):
    diff <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>dot(x, theta) <span style="color:#f92672">-</span> y
    <span style="color:#66d9ef">return</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">/</span> m) <span style="color:#f92672">*</span> (np<span style="color:#f92672">.</span>dot(np<span style="color:#f92672">.</span>transpose(x), diff))

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">gradient_descent</span>(x,y,lr):
    theta <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>])<span style="color:#f92672">.</span>reshape(<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>)
    index <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    gradient <span style="color:#f92672">=</span> gradient_function(theta,x,y)
    <span style="color:#66d9ef">while</span> <span style="color:#f92672">not</span> np<span style="color:#f92672">.</span>all(np<span style="color:#f92672">.</span>absolute(gradient) <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1e-5</span>):
        index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
        theta <span style="color:#f92672">=</span> theta <span style="color:#f92672">-</span> lr<span style="color:#f92672">*</span>gradient
        gradient <span style="color:#f92672">=</span> gradient_function(theta,x,y)
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">"gradient descent finish "</span><span style="color:#f92672">+</span>str(index)<span style="color:#f92672">+</span><span style="color:#e6db74">" traing"</span>)
    <span style="color:#66d9ef">return</span> theta
</code></pre></div><p>ä¸Šè¿°BGDè™½ç„¶å¯¹æ‰€æœ‰æ ·æœ¬è¿›è¡Œè®¡ç®—ï¼Œå¯ä»¥å¾ˆå¥½çš„å¾—åˆ°å…¨å±€æœ€ä¼˜ï¼Œä½†æ˜¯æ€§èƒ½å¹¶ä¸æ˜¯å¾ˆå¥½ï¼Œç”±äºæ¯æ¬¡è¿­ä»£éƒ½è¦è®¡ç®—æ‰€æœ‰æ ·æœ¬ï¼Œè®­ç»ƒè¿‡ç¨‹ä¼šå¾ˆæ…¢ã€‚</p>
<p>SGDï¼Œæ¯è½®è¿­ä»£ä¸­éƒ½åªéšæœºä¼˜åŒ–æŸä¸€æ¡è®­ç»ƒæ•°æ®çš„æŸå¤±ï¼Œæ›´æ–°é€Ÿåº¦æ¯”è¾ƒå¿«ï¼Œä½†æ˜¯ä¼šæ›´æ–°è‡³å±€éƒ¨æœ€ä¼˜ã€‚</p>
<pre><code>repeat{
â€ƒâ€ƒâ€ƒâ€ƒfor i=1,...,m{
â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒ ğœƒğ‘—:=ğœƒğ‘—âˆ’ğ›¼(â„ğœƒ(ğ‘¥(ğ‘–))âˆ’ğ‘¦(ğ‘–))ğ‘¥(ğ‘–)ğ‘—Î¸j:=Î¸jâˆ’Î±(hÎ¸(x(i))âˆ’y(i))xj(i)
â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒ(for j =0,1)
â€ƒâ€ƒâ€ƒâ€ƒ}
}
</code></pre><p>MBGDï¼Œéšæœºè®¡ç®—å°æ‰¹æ¬¡çš„æ•°æ®ï¼Œæ˜¯MGDä»¥åŠSGDçš„æŠ˜ä¸­ç‰ˆæœ¬ã€‚</p>
<pre><code>repeat{
â€ƒâ€ƒâ€ƒâ€ƒfor i=1,11,21,31,...,991{
â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒ ğœƒğ‘—:=ğœƒğ‘—âˆ’ğ›¼110âˆ‘(ğ‘–+9)ğ‘˜=ğ‘–(â„ğœƒ(ğ‘¥(ğ‘˜))âˆ’ğ‘¦(ğ‘˜))ğ‘¥(ğ‘˜)ğ‘—Î¸j:=Î¸jâˆ’Î±110âˆ‘k=i(i+9)(hÎ¸(x(k))âˆ’y(k))xj(k)
â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒ(for j =0,1)
â€ƒâ€ƒâ€ƒâ€ƒ}
â€ƒâ€ƒ}
</code></pre>
</section>
</article>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'ngc7293s-blog'; 

     
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://ngc7293s-blog.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<footer id="footer">
<div id="social">
<a class="symbol" href="https://www.facebook.com/">
<i class="fa fa-facebook-square"></i>
</a>
<a class="symbol" href="https://www.github.com/ngc7292">
<i class="fa fa-github-square"></i>
</a>
<a class="symbol" href="https://www.twitter.com/">
<i class="fa fa-twitter-square"></i>
</a>
</div>
<p class="small">
    
       Â© Copyright 2022 <i aria-hidden="true" class="fa fa-heart"></i> ngc7293
    
    </p>
<p class="small">
        Powered by <a href="http://www.gohugo.io/">Hugo</a> Theme By <a href="https://github.com/nodejh/hugo-theme-cactus-plus">nodejh</a>
</p>
</footer>
</section>
<script src="https://ngc7292.github.io/js/jquery-2.2.4.min.js"></script>
<script src="https://ngc7292.github.io/js/main.js"></script>
<script src="https://ngc7292.github.io/js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'ngc7293', 'auto');
	
	ga('send', 'pageview');
}
</script>
</body>
</html>
